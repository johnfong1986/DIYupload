<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Madhamster + Grok Moonshot Option Ladder v1.0004</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 1050px; margin: 30px auto; padding: 20px; background: #0d1117; color: #c9d1d9; }
    h1 { text-align: center; color: #58a6ff; text-shadow: 0 0 10px #58a6ff; margin-bottom: 20px; font-size: 2.2em; }
    label { display: block; margin: 15px 0 5px; font-weight: bold; color: #e6edf3; }
    input { width: 100%; padding: 10px; font-size: 16px; box-sizing: border-box; background: #21262d; color: #c9d1d9; border: 1px solid #30363d; border-radius: 6px; }
    button { width: 100%; padding: 14px; background: linear-gradient(90deg, #238636, #2ea043); color: white; border: none; font-size: 18px; font-weight: bold; cursor: pointer; margin: 25px 0 15px; border-radius: 6px; box-shadow: 0 4px 12px rgba(46,160,67,0.4); transition: all 0.2s; }
    button:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(46,160,67,0.6); }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.92em; background: #161b22; border-radius: 8px; overflow: hidden; }
    th, td { padding: 9px; text-align: left; border-bottom: 1px solid #30363d; }
    th { background: #21262d; color: #58a6ff; font-weight: bold; }
    .profit { color: #56d364; font-weight: bold; }
    .cash { color: #79c0ff; font-weight: bold; }
    .risk { color: #f85149; font-weight: bold; }
    .neutral { color: #8b949e; font-weight: bold; }
    .total { font-size: 1.1em; font-weight: bold; background: #21262d; padding: 14px; margin-top: 15px; text-align: center; border-radius: 8px; border: 1px solid #30363d; }
    .riskreward { background: #161b22; padding: 16px; margin-top: 15px; border-radius: 8px; border: 1px solid #30363d; text-align: center; font-size: 1.05em; }
  </style>
</head>
<body>
  <h1>Madhamster + Grok Moonshot Option Ladder v1.0004</h1>
  
  <label for="buyPrice">Buy Price per contract (e.g. 0.76):</label>
  <input type="number" id="buyPrice" step="0.01" min="0" placeholder="Entry price" value="0.76">

  <label for="numContracts">Number of Contracts (min 1):</label>
  <input type="number" id="numContracts" min="1" placeholder="e.g. 30" value="30">

  <button onclick="calculate()">Launch Moon Ladder</button>

  <div id="costDisplay" style="margin: 15px 0; font-weight: bold; text-align: center; font-size: 1.1em;"></div>

  <table id="results">
    <thead>
      <tr>
        <th>Target Gain</th>
        <th>Option Price</th>
        <th>% of Original</th>
        <th>Contracts Sold</th>
        <th>Remaining</th>
        <th>Cash Out this Sell</th>
        <th>Profit this Sell</th>
        <th>Max Potential Loss/Gain</th>
        <th>Cum. Profit %</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div id="totalProfit" class="total"></div>
  <div id="totalCashOut" class="total" style="background:#21262d; margin-top:10px;"></div>
  <div id="riskReward" class="riskreward"></div>

  <script>
    function formatNumber(num) {
      return num.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    function getValueClass(value) {
      if (value > 0) return 'profit';
      if (value < 0) return 'risk';
      return 'neutral';
    }

    function calculate() {
      const buy = parseFloat(document.getElementById('buyPrice').value);
      let initialContracts = parseInt(document.getElementById('numContracts').value);

      if (!buy || buy <= 0) { alert("Enter valid buy price!"); return; }
      if (!initialContracts || initialContracts < 1) { alert("Contracts must be at least 1!"); return; }

      const costPerContract = buy * 100;
      const totalCost = initialContracts * costPerContract;
      document.getElementById('costDisplay').innerHTML = 
        `Total Cost of Position: <span class="risk">$${formatNumber(totalCost)}</span>`;

      const tiers = [
        { gain: 100,    pctOrig: 50 },
        { gain: 200,    pctOrig: 8  },
        { gain: 400,    pctOrig: 8  },
        { gain: 800,    pctOrig: 10 },
        { gain: 1500,   pctOrig: 10 },
        { gain: 3000,   pctOrig: 4  },
        { gain: 6000,   pctOrig: 3  },
        { gain: 8000,   pctOrig: 2  },
        { gain: 10000,  pctOrig: 1.5},
        { gain: 20000,  pctOrig: 1  }
      ];

      let remaining = initialContracts;
      let totalProfitLocked = 0;
      let cumulativeCashOut = 0;
      const tableBody = document.querySelector('#results tbody');
      tableBody.innerHTML = '';

      tiers.forEach(tier => {
        const targetPrice = buy * (1 + tier.gain / 100);
        const sellFraction = tier.pctOrig / 100;
        let calcSell = initialContracts * sellFraction;
        let toSell = Math.floor(calcSell);

        if (toSell < 1 && remaining > 0) {
          toSell = 1;
        }

        toSell = Math.min(toSell, remaining);

        const cashThisSell = toSell * targetPrice * 100;
        const profitThis = cashThisSell - (toSell * costPerContract);
        totalProfitLocked += profitThis;
        cumulativeCashOut += cashThisSell;

        const remainingAfter = remaining - toSell;
        const maxPotentialLossGain = totalProfitLocked - (remainingAfter * costPerContract);

        remaining = remainingAfter;

        const cumProfitPct = totalCost > 0 ? (totalProfitLocked / totalCost * 100).toFixed(1) : 0;

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>+${tier.gain}%</td>
          <td>$${targetPrice.toFixed(2)}</td>
          <td>${tier.pctOrig}% orig</td>
          <td>${toSell}</td>
          <td>${remainingAfter}</td>
          <td class="cash">$${formatNumber(cashThisSell)}</td>
          <td class="profit">$${formatNumber(profitThis)}</td>
          <td class="${getValueClass(maxPotentialLossGain)}">$${formatNumber(Math.abs(maxPotentialLossGain))}${maxPotentialLossGain >= 0 ? '' : '-'}</td>
          <td class="profit">${cumProfitPct}%</td>
        `;
        tableBody.appendChild(row);
      });

      const lastPrice = buy * (1 + 20000 / 100);
      const unrealizedTop = remaining * (lastPrice - buy) * 100;
      const maxLoss = totalCost;
      const securedPct = (totalProfitLocked / totalCost * 100).toFixed(1);
      const riskLeft = ((maxLoss - totalProfitLocked) / maxLoss * 100).toFixed(0);

      document.getElementById('totalProfit').innerHTML = 
        `Total Profit Locked: <span class="profit">$${formatNumber(totalProfitLocked)}</span> (${securedPct}% of cost)`;

      document.getElementById('totalCashOut').innerHTML = 
        `Total Cash Out (gross received): <span class="cash">$${formatNumber(cumulativeCashOut)}</span>`;

      let rrText = `If remaining expires worthless tomorrow → net position would be <span class="${getValueClass(totalProfitLocked - (remaining * costPerContract))}">$${formatNumber(Math.abs(totalProfitLocked - (remaining * costPerContract)))}${totalProfitLocked - (remaining * costPerContract) >= 0 ? '' : '-'}</span><br>`;
      rrText += `But you've already secured ${securedPct}% → effective downside now ~${riskLeft}% of original risk.<br>`;
      rrText += remaining > 0 
        ? `Remaining ${remaining} trophy contracts could add ~$${formatNumber(unrealizedTop)} at +20,000% (ride it to the stars!)`
        : `All sold — position closed.`;

      document.getElementById('riskReward').innerHTML = rrText;
    }
  </script>
</body>
</html>

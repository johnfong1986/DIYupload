<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Madhamster + Grok Moonshot Option Ladder v1.0006</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 15px;
      background: #0d1117;
      color: #c9d1d9;
      min-height: 100vh;
      box-sizing: border-box;
    }
    h1 {
      text-align: center;
      color: #58a6ff;
      text-shadow: 0 0 10px #58a6ff;
      margin: 20px 0 25px;
      font-size: clamp(1.6rem, 5vw, 2.2rem);
    }
    label {
      display: block;
      margin: 12px 0 6px;
      font-weight: bold;
      color: #e6edf3;
      font-size: 1.05rem;
    }
    input {
      width: 100%;
      padding: 12px;
      font-size: 1.1rem;
      box-sizing: border-box;
      background: #21262d;
      color: #c9d1d9;
      border: 1px solid #30363d;
      border-radius: 6px;
      margin-bottom: 8px;
    }
    button {
      width: 100%;
      padding: 16px;
      background: linear-gradient(90deg, #238636, #2ea043);
      color: white;
      border: none;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      margin: 20px 0 15px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(46,160,67,0.4);
      transition: all 0.2s;
    }
    button:hover, button:active {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(46,160,67,0.6);
    }
    #costDisplay {
      margin: 15px 0;
      font-weight: bold;
      text-align: center;
      font-size: 1.15rem;
    }
    .table-container {
      overflow-x: auto;
      border: 1px solid #30363d;
      border-radius: 8px;
      margin: 15px 0;
      background: #161b22;
    }
    table {
      width: 100%;
      min-width: 900px;
      border-collapse: collapse;
      font-size: 0.92rem;
    }
    th, td {
      padding: 10px 12px;
      text-align: left;
      border-bottom: 1px solid #30363d;
    }
    th {
      background: #21262d;
      color: #58a6ff;
      font-weight: bold;
      position: sticky;
      top: 0;
      z-index: 1;
    }
    tr:hover {
      background: #1f2937;
    }
    .profit { color: #56d364; font-weight: bold; }
    .cash { color: #79c0ff; font-weight: bold; }
    .risk { color: #f85149; font-weight: bold; }
    .neutral { color: #8b949e; font-weight: bold; }
    .total {
      font-size: 1.1rem;
      font-weight: bold;
      background: #21262d;
      padding: 14px;
      margin: 15px 0;
      text-align: center;
      border-radius: 8px;
      border: 1px solid #30363d;
    }
    .riskreward {
      background: #161b22;
      padding: 16px;
      margin-top: 15px;
      border-radius: 8px;
      border: 1px solid #30363d;
      text-align: center;
      font-size: 1.05rem;
      line-height: 1.5;
    }
    /* ── Quick Cash-Out Section ── */
    #quickCashOut {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 20px;
      margin-top: 40px;
    }
    #quickCashOut h2 {
      margin-top: 0;
      color: #58a6ff;
      text-align: center;
      font-size: 1.4rem;
    }
    #quickCashOut p.intro {
      text-align: center;
      color: #8b949e;
      margin: 0 0 20px;
    }
    #cashoutResult {
      margin-top: 20px;
      padding: 15px;
      background: #0d1117;
      border-radius: 6px;
      border: 1px solid #30363d;
      font-size: 1.1rem;
      line-height: 1.6;
    }
    #cashoutResult .good { color: #56d364; }
    #cashoutResult .warn { color: #f85149; }
    @media (max-width: 768px) {
      body { padding: 10px; }
      h1 { margin: 15px 0; }
      button { padding: 18px; font-size: 1.3rem; }
      .table-container { margin: 10px -10px; border-radius: 0; }
      th, td { padding: 8px 10px; font-size: 0.88rem; }
    }
  </style>
</head>
<body>
  <h1>Madhamster + Grok Moonshot Option Ladder v1.0006</h1>
 
  <label for="buyPrice">Buy Price per contract (e.g. 0.76):</label>
  <input type="number" id="buyPrice" step="0.01" min="0" placeholder="Entry price" value="0.76">
  <label for="numContracts">Number of Contracts (min 1):</label>
  <input type="number" id="numContracts" min="1" placeholder="e.g. 30" value="30">
  <button onclick="calculate()">Launch Moon Ladder</button>
  <div id="costDisplay"></div>
  <div class="table-container">
    <table id="results">
      <thead>
        <tr>
          <th>Target Gain</th>
          <th>Option Price</th>
          <th>% of Original</th>
          <th>Sold</th>
          <th>Rem.</th>
          <th>Cash Out</th>
          <th>Profit</th>
          <th>Max Loss/Gain</th>
          <th>Cum. %</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  <div id="totalProfit" class="total"></div>
  <div id="totalCashOut" class="total" style="background:#21262d; margin-top:10px;"></div>
  <div id="riskReward" class="riskreward"></div>

  <!-- New Quick Cash-Out Section at the bottom -->
  <div id="quickCashOut">
    <h2>Quick: Get Your Total Cost Back</h2>
    <p class="intro">Enter current live option price → see how many contracts to sell to recover ≈ your original total cost.</p>
    
    <label for="livePrice">Current Live Option Price:</label>
    <input type="number" id="livePrice" step="0.01" min="0" placeholder="e.g. 2.45">

    <button onclick="calculateQuickCashOut()">Calculate Sell Qty</button>

    <div id="cashoutResult"></div>
  </div>

  <script>
    function formatNumber(num) {
      return num.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
    function getValueClass(value) {
      if (value > 0) return 'profit';
      if (value < 0) return 'risk';
      return 'neutral';
    }

    function calculate() {
      const buy = parseFloat(document.getElementById('buyPrice').value);
      let initialContracts = parseInt(document.getElementById('numContracts').value);
      if (!buy || buy <= 0) { alert("Enter valid buy price!"); return; }
      if (!initialContracts || initialContracts < 1) { alert("Contracts must be at least 1!"); return; }
      const costPerContract = buy * 100;
      const totalCost = initialContracts * costPerContract;
      document.getElementById('costDisplay').innerHTML =
        `Total Cost: <span class="risk">$${formatNumber(totalCost)}</span>`;

      const tiers = [
        { gain: 100,  pctOrig: 50 },
        { gain: 200,  pctOrig: 8 },
        { gain: 400,  pctOrig: 8 },
        { gain: 800,  pctOrig: 10 },
        { gain: 1500, pctOrig: 10 },
        { gain: 3000, pctOrig: 4 },
        { gain: 6000, pctOrig: 3 },
        { gain: 8000, pctOrig: 2 },
        { gain: 10000, pctOrig: 1.5},
        { gain: 20000, pctOrig: 1 }
      ];

      let remaining = initialContracts;
      let totalProfitLocked = 0;
      let cumulativeCashOut = 0;
      const tableBody = document.querySelector('#results tbody');
      tableBody.innerHTML = '';

      tiers.forEach(tier => {
        const targetPrice = buy * (1 + tier.gain / 100);
        const sellFraction = tier.pctOrig / 100;
        let calcSell = initialContracts * sellFraction;
        let toSell = Math.floor(calcSell);
        if (toSell < 1 && remaining > 0) toSell = 1;
        toSell = Math.min(toSell, remaining);

        const cashThisSell = toSell * targetPrice * 100;
        const profitThis = cashThisSell - (toSell * costPerContract);
        totalProfitLocked += profitThis;
        cumulativeCashOut += cashThisSell;

        const remainingAfter = remaining - toSell;
        const maxPotentialLossGain = totalProfitLocked - (remainingAfter * costPerContract);
        remaining = remainingAfter;

        const cumProfitPct = totalCost > 0 ? (totalProfitLocked / totalCost * 100).toFixed(1) : 0;

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>+${tier.gain}%</td>
          <td>$${targetPrice.toFixed(2)}</td>
          <td>${tier.pctOrig}% orig</td>
          <td>${toSell}</td>
          <td>${remainingAfter}</td>
          <td class="cash">$${formatNumber(cashThisSell)}</td>
          <td class="profit">$${formatNumber(profitThis)}</td>
          <td class="${getValueClass(maxPotentialLossGain)}">$${formatNumber(Math.abs(maxPotentialLossGain))}${maxPotentialLossGain >= 0 ? '' : '-'}</td>
          <td class="profit">${cumProfitPct}%</td>
        `;
        tableBody.appendChild(row);
      });

      const lastPrice = buy * (1 + 20000 / 100);
      const unrealizedTop = remaining * (lastPrice - buy) * 100;
      const maxLoss = totalCost;
      const securedPct = (totalProfitLocked / totalCost * 100).toFixed(1);
      const riskLeft = ((maxLoss - totalProfitLocked) / maxLoss * 100).toFixed(0);

      document.getElementById('totalProfit').innerHTML =
        `Total Profit Locked: <span class="profit">$${formatNumber(totalProfitLocked)}</span> (${securedPct}% of cost)`;
      document.getElementById('totalCashOut').innerHTML =
        `Total Cash Out: <span class="cash">$${formatNumber(cumulativeCashOut)}</span>`;

      let rrText = `If remaining expires worthless tomorrow → net position: <span class="${getValueClass(totalProfitLocked - (remaining * costPerContract))}">$${formatNumber(Math.abs(totalProfitLocked - (remaining * costPerContract)))}${totalProfitLocked - (remaining * costPerContract) >= 0 ? '' : '-'}</span><br>`;
      rrText += `Secured: ${securedPct}% → downside now ~${riskLeft}% of original risk.<br>`;
      rrText += remaining > 0
        ? `Trophy contracts left: ${remaining} — could add ~$${formatNumber(unrealizedTop)} at +20,000%`
        : `All sold — position closed.`;
      document.getElementById('riskReward').innerHTML = rrText;
    }

    function calculateQuickCashOut() {
      const buy = parseFloat(document.getElementById('buyPrice').value);
      const contracts = parseInt(document.getElementById('numContracts').value);
      const live = parseFloat(document.getElementById('livePrice').value);
      const resultDiv = document.getElementById('cashoutResult');

      resultDiv.innerHTML = '';

      if (isNaN(buy) || isNaN(contracts) || isNaN(live) || buy <= 0 || contracts < 1 || live <= 0) {
        resultDiv.innerHTML = '<span class="warn">Please fill buy price, contracts, and a valid live price > 0.</span>';
        return;
      }

      const totalCost = buy * contracts * 100;
      if (live <= buy) {
        resultDiv.innerHTML = '<span class="warn">Live price ≤ buy price — no recovery possible yet.</span>';
        return;
      }

      const gainPerContract = (live - buy) * 100;
      const exactContracts = totalCost / gainPerContract;
      const rounded = Math.round(exactContracts * 10) / 10; // 0.1 precision

      let cashBack = Math.round(rounded * gainPerContract);
      let msg = `Sell <strong>${rounded}</strong> contracts → get ≈ <span class="cash">$${formatNumber(cashBack)}</span> cash<br>`;
      msg += `(exact: ${exactContracts.toFixed(3)} contracts)<br><br>`;

      msg += `This recovers ≈ your total cost of $${formatNumber(totalCost)}<br>`;
      msg += `Leaves <strong>${contracts - Math.floor(rounded)}</strong>–<strong>${contracts - Math.ceil(rounded) + 1}</strong> contracts riding free.`;

      if (rounded > contracts) {
        const maxCash = Math.round(contracts * gainPerContract);
        msg += '<br><br><span class="warn">Not enough contracts — sell all for only $' + formatNumber(maxCash) + ' (partial recovery)</span>';
      }

      resultDiv.innerHTML = msg;
    }
  </script>
</body>
</html>
